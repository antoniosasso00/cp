(()=>{var e={};e.id=151,e.ids=[151],e.modules={5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},1877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},5319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},9491:e=>{"use strict";e.exports=require("assert")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},6224:e=>{"use strict";e.exports=require("tty")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},3188:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>o.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>d,routeModule:()=>x,tree:()=>c});var a=r(7096),s=r(6132),i=r(7284),o=r.n(i),n=r(2564),l={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>n[e]);r.d(t,l);let c=["",{children:["dashboard",{children:["catalog",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,9393)),"C:\\Users\\Anton\\Documents\\CarbonPilot\\frontend\\src\\app\\dashboard\\catalog\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,8182)),"C:\\Users\\Anton\\Documents\\CarbonPilot\\frontend\\src\\app\\dashboard\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,605)),"C:\\Users\\Anton\\Documents\\CarbonPilot\\frontend\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,9291,23)),"next/dist/client/components/not-found-error"]}],d=["C:\\Users\\Anton\\Documents\\CarbonPilot\\frontend\\src\\app\\dashboard\\catalog\\page.tsx"],u="/dashboard/catalog/page",p={require:r,loadChunk:()=>Promise.resolve()},x=new a.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/dashboard/catalog/page",pathname:"/dashboard/catalog",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},8411:(e,t,r)=>{Promise.resolve().then(r.bind(r,368))},368:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>v});var a=r(3854),s=r(4218),i=r(2416),o=r(9924),n=r(3110),l=r(2096),c=r(2496),d=r(2828),u=r(8504),p=r(1460),x=r(8521),m=r(9589);let g=p.z.object({part_number:p.z.string().min(1,"Part Number obbligatorio").max(50,"Massimo 50 caratteri"),descrizione:p.z.string().min(1,"Descrizione obbligatoria"),categoria:p.z.string().optional(),attivo:p.z.boolean(),note:p.z.string().optional()});function h({isOpen:e,onClose:t,onSuccess:r,item:l}){let[c,u]=(0,s.useState)({part_number:"",descrizione:"",categoria:"",attivo:!0,note:""}),[h,v]=(0,s.useState)({}),[j,b]=(0,s.useState)(!1),{toast:f}=(0,i.p)();(0,s.useEffect)(()=>{l?u({part_number:l.part_number,descrizione:l.descrizione,categoria:l.categoria||"",attivo:l.attivo,note:l.note||""}):u({part_number:"",descrizione:"",categoria:"",attivo:!0,note:""}),v({})},[l,e]);let N=(e,t)=>{u(r=>({...r,[e]:t})),h[e]&&v(t=>{let r={...t};return delete r[e],r})},C=()=>{try{return g.parse(c),{valid:!0,errors:{}}}catch(e){if(e instanceof p.z.ZodError){let t={};return e.errors.forEach(e=>{e.path[0]&&(t[e.path[0].toString()]=e.message)}),{valid:!1,errors:t}}return{valid:!1,errors:{form:"Errore di validazione"}}}},_=async()=>{let e=C();if(!e.valid){v(e.errors);return}b(!0);try{if(l){let e={descrizione:c.descrizione,categoria:c.categoria||void 0,attivo:c.attivo,note:c.note||void 0};await d.NN.update(l.part_number,e),f({variant:"success",title:"Aggiornato",description:`Part number ${l.part_number} aggiornato con successo.`})}else await d.NN.create(c),f({variant:"success",title:"Creato",description:`Nuovo part number ${c.part_number} creato con successo.`});r()}catch(t){console.error("Errore durante il salvataggio:",t);let e="Si \xe8 verificato un errore durante il salvataggio.";t instanceof Error&&(e=t.message),f({variant:"destructive",title:"Errore",description:e})}finally{b(!1)}};return a.jsx(x.Vq,{open:e,onOpenChange:t,children:(0,a.jsxs)(x.cZ,{className:"sm:max-w-[500px]",children:[a.jsx(x.fK,{children:a.jsx(x.$N,{children:l?`Modifica Part Number: ${l.part_number}`:"Crea Nuovo Part Number"})}),(0,a.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(m._,{htmlFor:"part_number",className:"text-right",children:"Part Number"}),a.jsx(n.I,{id:"part_number",value:c.part_number||"",onChange:e=>N("part_number",e.target.value),disabled:!!l,className:"col-span-3"}),h.part_number&&a.jsx("p",{className:"col-span-4 text-right text-sm text-destructive",children:h.part_number})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(m._,{htmlFor:"descrizione",className:"text-right",children:"Descrizione"}),a.jsx(n.I,{id:"descrizione",value:c.descrizione||"",onChange:e=>N("descrizione",e.target.value),className:"col-span-3"}),h.descrizione&&a.jsx("p",{className:"col-span-4 text-right text-sm text-destructive",children:h.descrizione})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(m._,{htmlFor:"categoria",className:"text-right",children:"Categoria"}),a.jsx(n.I,{id:"categoria",value:c.categoria||"",onChange:e=>N("categoria",e.target.value),className:"col-span-3",placeholder:"Opzionale"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(m._,{htmlFor:"note",className:"text-right",children:"Note"}),a.jsx(n.I,{id:"note",value:c.note||"",onChange:e=>N("note",e.target.value),className:"col-span-3",placeholder:"Opzionale"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(m._,{htmlFor:"attivo",className:"text-right",children:"Stato"}),a.jsx("div",{className:"col-span-3",children:(0,a.jsxs)("select",{id:"attivo",value:c.attivo?"true":"false",onChange:e=>N("attivo","true"===e.target.value),className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm",children:[a.jsx("option",{value:"true",children:"Attivo"}),a.jsx("option",{value:"false",children:"Non attivo"})]})})]})]}),(0,a.jsxs)(x.cN,{children:[a.jsx(o.z,{type:"button",variant:"outline",onClick:t,disabled:j,children:"Annulla"}),a.jsx(o.z,{type:"button",onClick:_,disabled:j,children:j?"Salvataggio...":l?"Aggiorna":"Crea"})]})]})})}function v(){let[e,t]=(0,s.useState)([]),[r,p]=(0,s.useState)(!0),[x,m]=(0,s.useState)(""),[g,v]=(0,s.useState)({}),[j,b]=(0,s.useState)(!1),[f,N]=(0,s.useState)(null),{toast:C}=(0,i.p)(),_=async()=>{try{p(!0);let e=await d.NN.getAll(g);t(e)}catch(e){console.error("Errore nel caricamento del catalogo:",e),C({variant:"destructive",title:"Errore",description:"Impossibile caricare il catalogo. Riprova pi\xf9 tardi."})}finally{p(!1)}};(0,s.useEffect)(()=>{_()},[g]);let z=e=>{N(e),b(!0)},y=async e=>{if(window.confirm(`Sei sicuro di voler eliminare ${e}?`))try{await d.NN.delete(e),C({variant:"success",title:"Eliminato",description:`Part number ${e} eliminato con successo.`}),_()}catch(t){console.error(`Errore durante l'eliminazione di ${e}:`,t),C({variant:"destructive",title:"Errore",description:`Impossibile eliminare ${e}. Potrebbe essere utilizzato in altre parti.`})}},P=e.filter(e=>{let t=x.toLowerCase();return e.part_number.toLowerCase().includes(t)||e.descrizione.toLowerCase().includes(t)||e.categoria&&e.categoria.toLowerCase().includes(t)}),q=Array.from(new Set(e.map(e=>e.categoria).filter(Boolean)));return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Catalogo"}),a.jsx("p",{className:"text-muted-foreground",children:"Gestisci i part number disponibili nel catalogo"})]}),a.jsx(o.z,{onClick:()=>{N(null),b(!0)},children:"Nuovo Part Number"})]}),(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-between",children:[a.jsx(n.I,{placeholder:"Cerca nel catalogo...",value:x,onChange:e=>m(e.target.value),className:"max-w-sm"}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsxs)("select",{className:"px-3 py-2 rounded-md border text-sm",value:g.categoria||"",onChange:e=>v({...g,categoria:e.target.value||void 0}),children:[a.jsx("option",{value:"",children:"Tutte le categorie"}),q.map(e=>a.jsx("option",{value:e,children:e},e))]}),(0,a.jsxs)("select",{className:"px-3 py-2 rounded-md border text-sm",value:void 0===g.attivo?"":g.attivo?"true":"false",onChange:e=>{let t=e.target.value;v({...g,attivo:""===t?void 0:"true"===t})},children:[a.jsx("option",{value:"",children:"Tutti gli stati"}),a.jsx("option",{value:"true",children:"Attivi"}),a.jsx("option",{value:"false",children:"Non attivi"})]})]})]}),r?a.jsx("div",{className:"flex justify-center py-8",children:a.jsx("p",{children:"Caricamento in corso..."})}):(0,a.jsxs)(l.iA,{children:[a.jsx(l.Rn,{children:"Lista dei part number nel catalogo"}),a.jsx(l.xD,{children:(0,a.jsxs)(l.SC,{children:[a.jsx(l.ss,{children:"Part Number"}),a.jsx(l.ss,{children:"Descrizione"}),a.jsx(l.ss,{children:"Categoria"}),a.jsx(l.ss,{className:"text-center",children:"Stato"}),a.jsx(l.ss,{children:"Ultima modifica"}),a.jsx(l.ss,{className:"text-right",children:"Azioni"})]})}),a.jsx(l.RM,{children:0===P.length?a.jsx(l.SC,{children:a.jsx(l.pj,{colSpan:6,className:"text-center py-8",children:"Nessun part number trovato"})}):P.map(e=>(0,a.jsxs)(l.SC,{children:[a.jsx(l.pj,{className:"font-medium",children:e.part_number}),a.jsx(l.pj,{className:"max-w-xs truncate",children:e.descrizione}),a.jsx(l.pj,{children:e.categoria||"-"}),a.jsx(l.pj,{className:"text-center",children:a.jsx(c.C,{variant:e.attivo?"success":"outline",children:e.attivo?"Attivo":"Non attivo"})}),a.jsx(l.pj,{children:(0,u.Q)(e.updated_at)}),a.jsx(l.pj,{className:"text-right",children:(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[a.jsx(o.z,{variant:"outline",size:"sm",onClick:()=>z(e),children:"Modifica"}),a.jsx(o.z,{variant:"destructive",size:"sm",onClick:()=>y(e.part_number),children:"Elimina"})]})})]},e.part_number))})]}),a.jsx(h,{isOpen:j,onClose:()=>b(!1),item:f,onSuccess:()=>{_(),b(!1)}})]})}},9393:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>o,__esModule:()=>i,default:()=>l});var a=r(5153);let s=(0,a.createProxy)(String.raw`C:\Users\Anton\Documents\CarbonPilot\frontend\src\app\dashboard\catalog\page.tsx`),{__esModule:i,$$typeof:o}=s,n=s.default,l=n}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[926,642,703,460,694],()=>r(3188));module.exports=a})();