(()=>{var e={};e.id=253,e.ids=[253],e.modules={5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},1877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},5319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},9491:e=>{"use strict";e.exports=require("assert")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},6224:e=>{"use strict";e.exports=require("tty")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},2572:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>n.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>x,tree:()=>d});var s=t(7096),i=t(6132),a=t(7284),n=t.n(a),o=t(2564),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);t.d(r,l);let d=["",{children:["dashboard",{children:["odl",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,9067)),"C:\\Users\\Anton\\Documents\\CarbonPilot\\frontend\\src\\app\\dashboard\\odl\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,8182)),"C:\\Users\\Anton\\Documents\\CarbonPilot\\frontend\\src\\app\\dashboard\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,605)),"C:\\Users\\Anton\\Documents\\CarbonPilot\\frontend\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,9291,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\Anton\\Documents\\CarbonPilot\\frontend\\src\\app\\dashboard\\odl\\page.tsx"],u="/dashboard/odl/page",p={require:t,loadChunk:()=>Promise.resolve()},x=new s.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/dashboard/odl/page",pathname:"/dashboard/odl",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},3148:(e,r,t)=>{Promise.resolve().then(t.bind(t,8259))},8259:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>C});var s=t(3854),i=t(4218),a=t.n(i),n=t(2416),o=t(9924),l=t(3110),d=t(2096),c=t(2496),u=t(2828),p=t(8521),x=t(8157),m=t(9589),h={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.298.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let f=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),g=(e,r)=>{let t=(0,i.forwardRef)(({color:t="currentColor",size:s=24,strokeWidth:a=2,absoluteStrokeWidth:n,className:o="",children:l,...d},c)=>(0,i.createElement)("svg",{ref:c,...h,width:s,height:s,stroke:t,strokeWidth:n?24*Number(a)/Number(s):a,className:["lucide",`lucide-${f(e)}`,o].join(" "),...d},[...r.map(([e,r])=>(0,i.createElement)(e,r)),...Array.isArray(l)?l:[l]]));return t.displayName=`${e}`,t},j=g("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);var v=t(8504);let b=a().forwardRef(({className:e,...r},t)=>s.jsx("textarea",{className:(0,v.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:t,...r}));b.displayName="Textarea";let N=({isOpen:e,onClose:r,item:t,onSuccess:a})=>{let{toast:d}=(0,n.p)(),[c,h]=(0,i.useState)([]),[f,g]=(0,i.useState)([]),[v,N]=(0,i.useState)(!1),[y,w]=(0,i.useState)(!1),[C,_]=(0,i.useState)({parte_id:0,tool_id:0,priorita:1,status:"Preparazione",note:""});(0,i.useEffect)(()=>{e&&(z(),t?_({parte_id:t.parte_id,tool_id:t.tool_id,priorita:t.priorita,status:t.status,note:t.note||""}):_({parte_id:0,tool_id:0,priorita:1,status:"Preparazione",note:""}))},[e,t]);let z=async()=>{try{N(!0);let[e,r]=await Promise.all([u.UK.getAll(),u.os.getAll()]);h(e),g(r)}catch(e){console.error("Errore nel caricamento delle dipendenze:",e),d({variant:"destructive",title:"Errore",description:"Impossibile caricare i dati necessari. Riprova pi\xf9 tardi."})}finally{N(!1)}},P=(e,r)=>{_(t=>({...t,[e]:r}))},S=async()=>{if(!C.parte_id||!C.tool_id){d({variant:"destructive",title:"Validazione fallita",description:"Seleziona una parte e un tool validi."});return}try{w(!0),t?(await u.LD.update(t.id,C),d({variant:"success",title:"ODL aggiornato",description:`ODL #${t.id} aggiornato con successo.`})):(await u.LD.create(C),d({variant:"success",title:"ODL creato",description:"Nuovo ODL creato con successo."})),a()}catch(e){console.error("Errore nel salvataggio dell'ODL:",e),d({variant:"destructive",title:"Errore",description:"Impossibile salvare l'ODL. Verifica i dati e riprova."})}finally{w(!1)}};return s.jsx(p.Vq,{open:e,onOpenChange:r,children:(0,s.jsxs)(p.cZ,{className:"sm:max-w-[500px]",children:[(0,s.jsxs)(p.fK,{children:[s.jsx(p.$N,{children:t?`Modifica ODL #${t.id}`:"Crea nuovo ODL"}),s.jsx(p.Be,{children:t?"Modifica i dettagli dell'ordine di lavoro":"Inserisci i dettagli per creare un nuovo ordine di lavoro"})]}),v?(0,s.jsxs)("div",{className:"flex justify-center items-center py-8",children:[s.jsx(j,{className:"h-8 w-8 animate-spin"}),s.jsx("span",{className:"ml-2",children:"Caricamento in corso..."})]}):(0,s.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[s.jsx(m._,{htmlFor:"parte_id",className:"text-right",children:"Parte"}),s.jsx("div",{className:"col-span-3",children:(0,s.jsxs)(x.Ph,{value:C.parte_id?.toString()||"",onValueChange:e=>P("parte_id",parseInt(e)),children:[s.jsx(x.i4,{children:s.jsx(x.ki,{placeholder:"Seleziona una parte"})}),s.jsx(x.Bw,{children:f.map(e=>(0,s.jsxs)(x.Ql,{value:e.id.toString(),children:[e.part_number," - ",e.descrizione_breve]},e.id))})]})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[s.jsx(m._,{htmlFor:"tool_id",className:"text-right",children:"Tool"}),s.jsx("div",{className:"col-span-3",children:(0,s.jsxs)(x.Ph,{value:C.tool_id?.toString()||"",onValueChange:e=>P("tool_id",parseInt(e)),children:[s.jsx(x.i4,{children:s.jsx(x.ki,{placeholder:"Seleziona un tool"})}),s.jsx(x.Bw,{children:c.map(e=>(0,s.jsxs)(x.Ql,{value:e.id.toString(),children:[e.codice," ",e.descrizione?`- ${e.descrizione}`:""]},e.id))})]})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[s.jsx(m._,{htmlFor:"priorita",className:"text-right",children:"Priorit\xe0"}),s.jsx(l.I,{id:"priorita",type:"number",min:1,value:C.priorita||1,onChange:e=>P("priorita",parseInt(e.target.value)),className:"col-span-3"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[s.jsx(m._,{htmlFor:"status",className:"text-right",children:"Stato"}),s.jsx("div",{className:"col-span-3",children:(0,s.jsxs)(x.Ph,{value:C.status||"Preparazione",onValueChange:e=>P("status",e),children:[s.jsx(x.i4,{children:s.jsx(x.ki,{placeholder:"Seleziona lo stato"})}),(0,s.jsxs)(x.Bw,{children:[s.jsx(x.Ql,{value:"Preparazione",children:"Preparazione"}),s.jsx(x.Ql,{value:"Laminazione",children:"Laminazione"}),s.jsx(x.Ql,{value:"Attesa Cura",children:"Attesa Cura"}),s.jsx(x.Ql,{value:"Cura",children:"Cura"}),s.jsx(x.Ql,{value:"Finito",children:"Finito"})]})]})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[s.jsx(m._,{htmlFor:"note",className:"text-right",children:"Note"}),s.jsx(b,{id:"note",placeholder:"Note aggiuntive sull'ordine di lavoro",value:C.note||"",onChange:e=>P("note",e.target.value),className:"col-span-3"})]})]}),(0,s.jsxs)(p.cN,{children:[s.jsx(o.z,{variant:"outline",onClick:r,children:"Annulla"}),(0,s.jsxs)(o.z,{onClick:S,disabled:y,children:[y&&s.jsx(j,{className:"mr-2 h-4 w-4 animate-spin"}),t?"Aggiorna":"Crea"]})]})]})})},y=g("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),w=e=>({Preparazione:"secondary",Laminazione:"primary","Attesa Cura":"warning",Cura:"destructive",Finito:"success"})[e]||"default";function C(){let[e,r]=(0,i.useState)([]),[t,a]=(0,i.useState)(!0),[p,x]=(0,i.useState)(""),[m,h]=(0,i.useState)({}),[f,g]=(0,i.useState)(!1),[v,b]=(0,i.useState)(null),{toast:C}=(0,n.p)(),_=async()=>{try{a(!0);let e=await u.LD.getAll(m);r(e)}catch(e){console.error("Errore nel caricamento degli ODL:",e),C({variant:"destructive",title:"Errore",description:"Impossibile caricare gli ordini di lavoro. Riprova pi\xf9 tardi."})}finally{a(!1)}};(0,i.useEffect)(()=>{_()},[m]);let z=e=>{b(e),g(!0)},P=async e=>{if(window.confirm(`Sei sicuro di voler eliminare l'ODL con ID ${e}?`))try{await u.LD.delete(e),C({variant:"success",title:"Eliminato",description:`ODL con ID ${e} eliminato con successo.`}),_()}catch(r){console.error(`Errore durante l'eliminazione dell'ODL ${e}:`,r),C({variant:"destructive",title:"Errore",description:`Impossibile eliminare l'ODL con ID ${e}.`})}},S=e.filter(e=>{let r=p.toLowerCase();return e.parte.part_number.toLowerCase().includes(r)||e.tool.codice.toLowerCase().includes(r)||e.note&&e.note.toLowerCase().includes(r)});return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[s.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Ordini di Lavoro"}),s.jsx("p",{className:"text-muted-foreground",children:"Gestisci gli ordini di lavoro in produzione"})]}),s.jsx(o.z,{onClick:()=>{b(null),g(!0)},children:"Nuovo ODL"})]}),s.jsx("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-between",children:s.jsx(l.I,{placeholder:"Cerca negli ODL...",value:p,onChange:e=>x(e.target.value),className:"max-w-sm"})}),t?(0,s.jsxs)("div",{className:"flex justify-center py-8",children:[s.jsx(j,{className:"h-8 w-8 animate-spin"}),s.jsx("span",{className:"ml-2",children:"Caricamento in corso..."})]}):(0,s.jsxs)(d.iA,{children:[s.jsx(d.Rn,{children:"Lista degli ordini di lavoro in produzione"}),s.jsx(d.xD,{children:(0,s.jsxs)(d.SC,{children:[s.jsx(d.ss,{children:"ID"}),s.jsx(d.ss,{children:"Part Number"}),s.jsx(d.ss,{children:"Tool"}),s.jsx(d.ss,{className:"text-center",children:"Priorit\xe0"}),s.jsx(d.ss,{className:"text-center",children:"Stato"}),s.jsx(d.ss,{children:"Note"}),s.jsx(d.ss,{className:"text-right",children:"Azioni"})]})}),s.jsx(d.RM,{children:0===S.length?s.jsx(d.SC,{children:s.jsx(d.pj,{colSpan:7,className:"text-center py-8",children:"Nessun ordine di lavoro trovato"})}):S.map(e=>(0,s.jsxs)(d.SC,{children:[s.jsx(d.pj,{className:"font-medium",children:e.id}),s.jsx(d.pj,{children:(0,s.jsxs)("div",{className:"flex flex-col",children:[s.jsx("span",{children:e.parte.part_number}),s.jsx("span",{className:"text-xs text-muted-foreground truncate max-w-[200px]",children:e.parte.descrizione_breve})]})}),s.jsx(d.pj,{children:e.tool.codice}),s.jsx(d.pj,{className:"text-center",children:s.jsx(c.C,{variant:e.priorita>5?"destructive":e.priorita>2?"warning":"secondary",children:e.priorita})}),s.jsx(d.pj,{className:"text-center",children:s.jsx(c.C,{variant:w(e.status),children:e.status})}),s.jsx(d.pj,{className:"max-w-[200px] truncate",children:e.note||"-"}),s.jsx(d.pj,{className:"text-right",children:(0,s.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,s.jsxs)(o.z,{variant:"outline",size:"sm",onClick:()=>z(e),children:[s.jsx(y,{className:"h-4 w-4 mr-1"}),"Modifica"]}),s.jsx(o.z,{variant:"destructive",size:"sm",onClick:()=>P(e.id),children:"Elimina"})]})})]},e.id))})]}),s.jsx(N,{isOpen:f,onClose:()=>g(!1),item:v,onSuccess:()=>{_(),g(!1)}})]})}},8157:(e,r,t)=>{"use strict";t.d(r,{Bw:()=>u,Ph:()=>l,Ql:()=>x,i4:()=>c,ki:()=>d});var s=t(3854),i=t(4218),a=t(9931),n=t(1098),o=t(8504);let l=n.fC;n.ZA;let d=n.B4,c=i.forwardRef(({className:e,children:r,...t},i)=>(0,s.jsxs)(n.xz,{ref:i,className:(0,o.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:[r,s.jsx(n.JO,{asChild:!0,children:s.jsx(a.jnn,{className:"h-4 w-4 opacity-50"})})]}));c.displayName=n.xz.displayName;let u=i.forwardRef(({className:e,children:r,position:t="popper",...i},a)=>s.jsx(n.h_,{children:s.jsx(n.VY,{ref:a,className:(0,o.cn)("relative z-50 min-w-[8rem] overflow-hidden rounded-md border bg-background text-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===t&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:t,...i,children:s.jsx(n.l_,{className:(0,o.cn)("p-1","popper"===t&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r})})}));u.displayName=n.VY.displayName;let p=i.forwardRef(({className:e,...r},t)=>s.jsx(n.__,{ref:t,className:(0,o.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...r}));p.displayName=n.__.displayName;let x=i.forwardRef(({className:e,children:r,...t},i)=>(0,s.jsxs)(n.ck,{ref:i,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...t,children:[s.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:s.jsx(n.wU,{children:s.jsx(a.nQG,{className:"h-4 w-4"})})}),s.jsx(n.eT,{children:r})]}));x.displayName=n.ck.displayName;let m=i.forwardRef(({className:e,...r},t)=>s.jsx(n.Z0,{ref:t,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",e),...r}));m.displayName=n.Z0.displayName},9067:(e,r,t)=>{"use strict";t.r(r),t.d(r,{$$typeof:()=>n,__esModule:()=>a,default:()=>l});var s=t(5153);let i=(0,s.createProxy)(String.raw`C:\Users\Anton\Documents\CarbonPilot\frontend\src\app\dashboard\odl\page.tsx`),{__esModule:a,$$typeof:n}=i,o=i.default,l=o},24:(e,r,t)=>{"use strict";t.d(r,{D:()=>i});var s=t(4218);function i(e){let r=s.useRef({value:e,previous:e});return s.useMemo(()=>(r.current.value!==e&&(r.current.previous=r.current.value,r.current.value=e),r.current.previous),[e])}},5440:(e,r,t)=>{"use strict";t.d(r,{t:()=>a});var s=t(4218),i=t(6223);function a(e){let[r,t]=s.useState(void 0);return(0,i.b)(()=>{if(e){t({width:e.offsetWidth,height:e.offsetHeight});let r=new ResizeObserver(r=>{let s,i;if(!Array.isArray(r)||!r.length)return;let a=r[0];if("borderBoxSize"in a){let e=a.borderBoxSize,r=Array.isArray(e)?e[0]:e;s=r.inlineSize,i=r.blockSize}else s=e.offsetWidth,i=e.offsetHeight;t({width:s,height:i})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}t(void 0)},[e]),r}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[926,642,703,98,694],()=>t(2572));module.exports=s})();